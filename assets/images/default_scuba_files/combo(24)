YUI.add("hermes-template-photo-list-demo-subview",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){return e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["photo-list-view"]:t,{name:"outlet",hash:{},data:i}))},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-list-demo-subview",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-selector-photolist-view",function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{initializer:function(t){return t.photolistViewClasses&&(t.additionalViewClasses=t.photolistViewClasses),t.photoListConfig=e.merge(t.primaryPhotoListConfig),t.publicOnlyPhotos=t.publicOnlyPhotos,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("photo-list-demo-subview"),this},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","photo-list-view","hermes-template-photo-list-demo-subview"]});
YUI.add("photo-selector-limited-rows-photolist-view",function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return t.photolistViewClasses&&(t.additionalViewClasses=t.photolistViewClasses),t.photoListConfig=e.merge(t.primaryPhotoListConfig),this.searchUrl=t.searchUrl,this.listId=t.listId,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){return this.appContext.getModel("search-photos-lite-models",this.searchUrl.getId(),{}).then(function(e){this.searchModel=e,e.getValue("totalItems")<=0&&this.set("emptySearch",!0)}.bind(this))},buildContainer:function(){var e="search.YOUR_PHOTOS";return this.listId==="contacts"?e="search.FROM_YOUR_CONTACTS":this.listId==="everyone"&&(e="search.EVERYONES_PHOTOS"),this.setContainerWithTemplate("search-photos-single-row",{emptySearch:this.get("emptySearch"),total:this.searchModel.getValue("totalItems"),singleResult:this.searchModel.getValue("totalItems")===1,viewAll:"#"+this.listId,"photo-list-view":this.subviews["photo-list-view"].get("container"),title:this.intlMessage({intlName:e})}),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.handleClick.bind(this))),this},handleClick:function(e){e.halt();var t=e.target,n;t.hasClass("view-more-link")&&(n=t.getDOMNode().href.split("#")[1],this.fire("subviewViewEvent","viewEntireSearchList",{list:n,searchUrl:this.searchUrl}))}},{ATTRS:{emptySearch:{value:!1}}})},"@VERSION@",{requires:["flickr-view","photo-list-view","hermes-template-search-photos-single-row","search-photos-lite-models"],langBundles:["common","search"]});
YUI.add("hermes-template-photo-selector-photo-list-photo-interaction",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=e.escapeExpression;return'<a href="'+o(e.lambda((s=(s=t!=null?t.photo:t)!=null?s.owner:s)!=null?s.url:s,t))+'" class="attribution">'+o((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{user:(s=(s=t!=null?t.photo:t)!=null?s.owner:s)!=null?s.displayname:s,intlName:"common.BY_USER"},data:i}))+"</a>"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=e.escapeExpression;return'<div class="photo-list-photo-interaction">\n	<div class="square"></div>\n	<div class="interaction-bar">\n		<div class="text">\n			<a href="'+a((o=(o=n.photoPageUrl||(t!=null?t.photoPageUrl:t))!=null?o:n.helperMissing,typeof o=="function"?o.call(u,{name:"photoPageUrl",hash:{},data:i}):o))+'" class="title">'+a(e.lambda((s=t!=null?t.photo:t)!=null?s.title:s,t))+"</a>\n			"+((s=n["if"].call(u,(s=(s=t!=null?t.photo:t)!=null?s.owner:s)!=null?s.displayname:s,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n		</div>\n	</div>\n</div>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-selector-photo-list-photo-interaction",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-selector-photolist-interaction-view",function(e){var t=require("lib/helpers/type-validator");"use strict",e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.hasMultiSelect=e.primaryPhotoListConfig&&e.primaryPhotoListConfig.hasMultiSelect,this.multiSelectLimit=e.primaryPhotoListConfig.multiSelectLimit||1,this},loadState:function(){return this.appContext.getModel("profile-selected-photos-models",this.appContext.getViewer().nsid).then(function(e){var t=e.getValue("photos");t.getFromListByID(this.get("model").getValue("id"))&&this.set("isActive",!0)}.bind(this))},buildContainer:function(){var e=this.get("model");return this.setContainerWithTemplate("photo-selector-photo-list-photo-interaction",{photo:e.toJSON(),photoPageUrl:this.get("photoPageUrl")}),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.selectPhoto.bind(this))),this.hasMultiSelect||this.registerEventHandler(e.on("photoSelector:subviewEvent",this.handleOtherPhotoSelected,this)),this.get("isActive")?this.get("isActive")&&this.get("container").addClass("active"):this.get("container").removeClass("active"),this},selectPhoto:function(t){t.halt();if(this.get("isActive")&&this.hasMultiSelect)this.set("isActive",!1),this.get("container").removeClass("active"),e.fire("photoSelector:subviewEvent",{eventName:"unselectPhotoFromPhotoList",id:this.get("id")});else{if(this.hasMultiSelect)return this.appContext.getModel("profile-selected-photos-models",this.appContext.getViewer().nsid).then(function(t){var n=t.getValue("photos");n.size()+1<=this.multiSelectLimit&&(this.set("isActive",!0),this.get("container").addClass("active"),e.fire("photoSelector:subviewEvent",{eventName:"selectPhotoFromPhotoList",id:this.get("id")}))}.bind(this));this.set("isActive",!0),this.get("container").addClass("active"),e.fire("photoSelector:subviewEvent",{eventName:"selectPhotoFromPhotoList",id:this.get("id")})}},handleOtherPhotoSelected:function(e){if(e.eventName==="selectPhotoFromPhotoList"&&this.get("isActive")){if(e.id===this.get("id"))return;this.set("isActive",!1),this.get("container")._node&&this.get("container").removeClass("active")}}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,n){return t.photoId(e)}},model:{writeOnce:"initOnly"},photoPageUrl:{writeOnce:"initOnly"}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-selector-photo-list-photo-interaction","attribute-helpers"],optionalRequires:["fluid"],langBundles:["common"]});
YUI.add("hermes-template-photo-selector-sets-photolist-set-interaction",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return'				<span class="album-photo-count">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{selectedCount:(s=t!=null?t.album:t)!=null?s.publicPhotosCount:s,intlName:"album-page.PUBLIC_ITEMS_COUNT"},data:i}))+"</span>\n"},3:function(e,t,n,r,i){var s;return'			<span class="album-photo-count">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{selectedCount:(s=t!=null?t.album:t)!=null?s.totalCount:s,intlName:"album-page.PHOTOS_COUNT"},data:i}))+"</span>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return'<div class="photo-list-album-interaction photo-selector-album dark">\n	<div class="interaction-bar">\n		<h4 class="album-title">'+e.escapeExpression(e.lambda((s=t!=null?t.album:t)!=null?s.title:s,t))+"</h4>\n"+((s=n["if"].call(t!=null?t:{},t!=null?t.publicOnlyPhotos:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+"	</div>\n</div>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-selector-sets-photolist-set-interaction",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-selector-sets-photolist-interaction-view",function(e){var t=require("lib/helpers/type-validator");"use strict",e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.publicOnlyPhotos=e.publicOnlyPhotos,this},loadState:function(){return this.appContext.getModel(this.get("engagementModelName"),this.get("id")).then(function(e){this.set("engagement",e)}.bind(this))},buildContainer:function(){return this.setContainerWithTemplate("photo-selector-sets-photolist-set-interaction",{album:this.get("model").toJSON(),publicOnlyPhotos:this.publicOnlyPhotos,albumPageUrl:this.get("albumPageUrl")}),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.selectSet.bind(this))),this},selectSet:function(t){t.halt(),e.fire("photoSelector:subviewEvent",{eventName:"selectSetFromPhotoList",id:this.get("id"),title:this.get("model").getValue("title")})},destructor:function(){}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,n){return t.photoId(e)}},model:{writeOnce:"initOnly"},albumPageUrl:{writeOnce:"initOnly"},engagement:{value:null},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(t,n){return e.AttributeHelpers.validateString(t)}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-selector-sets-photolist-set-interaction","attribute-helpers"],optionalRequires:["fluid"],langBundles:["album-page"]});
YUI.add("hermes-lang-album-page",function(e,t){e.Intl.add("hermes/album-page","en-US",{PHOTOS_COUNT:[{type:"plural",valueName:"selectedCount",options:{one:"${#} photo",other:"${#} photos"}}],PUBLIC_PHOTOS_COUNT:[{type:"plural",valueName:"selectedCount",options:{one:"${#} public photo",other:"${#} public photos"}}],PUBLIC_ITEMS_COUNT:[{type:"plural",valueName:"selectedCount",options:{one:"${#} public item",other:"${#} public items"}}],VIDEOS_COUNT:[{type:"plural",valueName:"selectedCount",options:{one:"${#} video",other:"${#} videos"}}],VIEWS_COUNT:[{type:"plural",valueName:"selectedCount",options:{one:"${#} view",other:"${#} views"}}],BACK_TO_ALBUMS:["Back to albums list"],EDIT_IN_ORGANIZR:["Edit in Organizr"],EDIT_COVER:["Edit cover"],SELECT_COVER_PHOTO:["Select a cover photo"],SELECT:["Select"],ERROR_COVER_PHOTO:["There was a problem trying to set your cover photo. Please try again."],ERROR_UPDATING_ALBUM_TITLE_DESCRIPTION:["There was an error updating the album's title and description."],ALBUM_ADD_DESCRIPTION:["Click here to enter a description for this album"],ERROR_CREATING_PHOTOBOOK_FROM_ALBUM:["There was a problem creating the book for this album. Please try again later."],ALBUM_DESCRIPTION:["Album description"],CREATE_BOOK_FROM_ALBUM:["Make a book from this Album"],DOWNLOAD_PHOTOS_AND_VIDEO:["Download ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}," & ",{type:"plural",valueName:"videoCount",options:{one:"${#} video",other:"${#} videos"}}],DOWNLOAD_PHOTOS:["Download ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}],DOWNLOAD_VIDEOS:["Download ",{type:"plural",valueName:"videoCount",options:{one:"${#} video",other:"${#} videos"}}],DOWNLOAD_ZIP:["Download zip"],DOWNLOAD_ZIP_PART:["Download zip part ","${partSequence}"],ALOT_OF_PHOTOS:["Wow, that's a lot of photos! Click to download each batch as a zip file."],DOWNLOAD_ALBUM_NOT_AVAILABLE_ERROR:["There are no photos or videos available in this album for you to download."],DOWNLOAD_ALBUM_DISABLED_ERROR:["Album downloading is currently unavailable. Please try again in a minute."],DOWNLOAD_ALBUM_GENERIC_ERROR:["There was an error downloading this album. Please try again."],DOWNLOAD_ALBUM_LICENSE_MESSAGE:["These photos may have one or more license types. Please visit the individual photo page for more information about the license prior to downloading this album."],DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT:["These photos may have one or more license types. Prior to downloading this album, please visit the individual photo pages to understand the designated license type for each image"],DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT_2:["These photos may have one or more license types or their rights may be reserved. Prior to downloading this album, please visit the individual photo pages to understand the designated license type for each image."],DOWNLOAD_ALBUM_LEARN_MORE:['Learn more at <a href="https://www.flickr.com/creativecommons" target="_blank">Creative Commons</a>'],CONFIRM_ALBUM_DELETE_NO_CONTENTS_DELETED:["Do you really want to delete this album? (Don't worry, none of the contents will be deleted.)"],DELETE_THIS_ALBUM:["Delete this album"],SHARE_THIS_ALBUM:["Share this album"],CREATE_NEW_ALBUM:["Create new album"],NEW_ALBUM:["New album"],NEW_COLLECTION:["New collection"],VIEW_COLLECTIONS:["View collections"],VIEW_MY_COLLECTIONS:["View my collections"],SORT:["Sort"],SORT_DATE_TAKEN_OLDEST:["Sort by date taken (oldest first)"],SORT_DATE_TAKEN_NEWEST:["Sort by date taken (newest first)"],SORT_DATE_UPLOADED_OLDEST:["Sort by date uploaded (oldest first)"],SORT_DATE_UPLOADED_NEWEST:["Sort by date uploaded (newest first)"],SORT_ALPHABETICALLY:["Alphabetically"],SORT_RANDOMLY:["Randomly"],SORT_REVERSE:["Reverse current order"],SORT_ALMOST_DONE:["Almost done..."],TIMEOUT_FAILURE:["We're having some trouble displaying this album at the moment. Please try again."]})},"@VERSION@",{requires:["intl"]});
YUI.add("photo-selector-view",function(e,t){var n=require("lib/flog")(t),r=150,i=200,s={};s={horizontal:20,vertical:20},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").getHTML()===""&&this.setContainerWithTemplate("flickr-balls"),this.photoListView,this.searchPhotoListViews=[],this.publicOnlyGroups=e.publicOnlyGroups,this.publicOnlyPhotos=e.publicOnlyPhotos,this.enableMultiSelect=e.enableMultiSelect||!1,this.multiSelectLimit=e.multiSelectLimit||1,this.preSelectedPhotos=e.preSelectedPhotos||[],this.clearRegistriesOnDestroy=e.clearRegistriesOnDestroy||!1,this.selectedModels=[],e.enableVideos&&this.set("itemFilterFunction",!1),this.isUploading=!1,this},loadState:function(){var t=this.appContext.getViewer().nsid;this.publicOnlyPhotos&&(t+="-public");var n={selectionModel:this.appContext.getModel("profile-selected-photos-models",this.appContext.getViewer().nsid),photostreamModel:this.appContext.getModel("photostream-models",t),setModelRegistry:this.appContext.getModelRegistry("set-models"),setsModel:this.appContext.getModel("sets-models",this.appContext.getViewer().nsid,{page:1,perPage:25})};return(new e.FlickrPromise(n)).then(this.onLoadStateResolved.bind(this))},onLoadStateResolved:function(e){this.set("selectionModel",e.selectionModel),this.set("photostreamModel",e.photostreamModel),this.set("setsModel",e.setsModel),this.set("setModelRegistry",e.setModelRegistry),this.enableMultiSelect&&this.get("selectionModel").setValue("photos",this.preSelectedPhotos?this.preSelectedPhotos:[]),this.get("photostreamModel").getValue("totalItems")===0?this.set("photostreamEmpty",!0):this.set("photostreamEmpty",!1);if(this.get("groupId"))return this.appContext.getModel("group-pool-models",this.get("groupId")).then(function(e){this.set("groupModel",e)}.bind(this),function(e){n.error("error loading group model",{err:e})})},moveElementToFirstInArray:function(e,t,n){var r;return e.forEach(function(e,i){e[n]===t&&(r=i)}),e.unshift(e.splice(r,1)[0]),e},buildContainer:function(){return this.setContainerWithTemplate("photo-selector",{hasUploadCapabilities:this.get("hasUploadCapabilities"),searchable:this.get("searchable"),publicOnlyPhotos:this.get("publicOnlyPhotos"),photostreamEmpty:this.get("photostreamEmpty"),hasGroupCapabilities:this.get("groupId")}),this},loadPhotoList:function(t,i){var o=this,u=this.get("container"),a=u.one(".photo-selector-photos-wrapper"),f;this.photoListView&&this.photoListView.destroy(),i||(i=!1),f={modelParams:t,fetchParams:t.fetchParams,parentName:this.name,hasMultiSelect:this.enableMultiSelect,multiSelectLimit:this.multiSelectLimit,paginateOnScroll:!0,parentContainer:a,relayoutOnResize:!0,interactionViewName:this.get("interactionViewName")},this.get("itemFilterFunction")&&(f.itemFilterFunction=this.get("itemFilterFunction")),f.layout={targetRowHeight:r,containerWidth:f.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:20,bottom:10,left:20},itemSpacing:s,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:a.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=f,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:f,isActiveViewAgnostic:!0,container:u.one(".photo-selector-photos-container")}).then(function(t){return t.initialize().then(function(t){var n,r=u.one(".photo-selector-photos-container"),s=r.one(".photo-list-view"),f=u.one(".loader");a.getDOMNode().scrollTop=0,o.photoListView=t,f&&f.addClass("loaded"),s.hasChildNodes()||(i?n=e.Node.create('<p class="no-results">'+o.intlMessage({intlName:"search.NO_MATCHES_FOR_QUERY_TERM_YOUR"})+"</p>"):o.publicOnlyPhotos?n=e.Node.create('<p class="no-results">'+o.intlMessage({intlName:"common.PHOTO_SELECTOR_EMPTY_PUBLIC_PHOTOS"})+"</p>"):n=e.Node.create('<p class="no-results">'+o.intlMessage({intlName:"common.PHOTO_SELECTOR_EMPTY_PHOTOS"})+"</p>"),s.empty(),r.prepend(n)),o.addPhotoToSelection(null)})},function(e){n.error("Error getting view",{err:e})})},loadSelectionPhotoList:function(){var t=this,i=this.get("container"),o=i.one(".photo-selector-photos-wrapper"),u;this.photoListView&&this.photoListView.destroy(),u={parentName:this.name,hasMultiSelect:this.enableMultiSelect,multiSelectLimit:this.multiSelectLimit,paginateOnScroll:!0,initialItems:this.get("selectionModel").getValue("photos").getList(),parentContainer:o,relayoutOnResize:!0,interactionViewName:"photo-selector-selection-interaction-view"},u.layout={targetRowHeight:r,containerWidth:u.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:20,bottom:10,left:20},itemSpacing:s,forceAspectRatio:1,alwaysDisplayOrphans:!0,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:o.get("offsetHeight")},this.get("itemFilterFunction")&&(u.itemFilterFunction=this.get("itemFilterFunction")),this.appContext.params.primaryPhotoListConfig=u,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:u,isActiveViewAgnostic:!0,nsid:this.appContext.getViewer().nsid,container:i.one(".photo-selector-photos-container")}).then(function(n){return n.initialize().then(function(n){var r,s=i.one(".photo-selector-photos-container"),u=s.one(".photo-list-view"),a=i.one(".loader");s.addClass("photo-selector-selection-photolist"),o.getDOMNode().scrollTop=0,t.photoListView=n,a&&a.addClass("loaded"),u.hasChildNodes()||(r=e.Node.create('<p class="no-results">'+t.intlMessage({intlName:"profile.NO_PHOTOS_SELECTED"})+"</p>"),u.empty(),s.prepend(r))})},function(e){n.error("Error getting view",{err:e})})},loadGroupPhotoList:function(t){var i=this,o=this.get("container"),u=o.one(".group-photo-selector-photos-wrapper"),a;this.photoListView&&this.photoListView.destroy(),a={modelParams:t,parentName:this.name,paginateOnScroll:!0,parentContainer:u,relayoutOnResize:!0,interactionViewName
:this.get("interactionViewName")},this.get("itemFilterFunction")&&(a.itemFilterFunction=this.get("itemFilterFunction")),a.layout={targetRowHeight:r,containerWidth:a.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:20,bottom:10,left:20},itemSpacing:s,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:u.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=a,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:a,isActiveViewAgnostic:!0,container:u}).then(function(t){return t.initialize().then(function(t){var n,r=o.one(".group-photo-selector-photos-container"),s=r.one(".photo-list-view");u.getDOMNode().scrollTop=0,i.photoListView=t,o.one(".loader").addClass("loaded"),s.hasChildNodes()||(n=e.Node.create('<p class="no-results">'+i.intlMessage({intlName:"groups.GROUP_POOL_CONTAINS_NO_PUBLIC_PHOTOS"})+"</p>"),s.empty(),r.prepend(n)),i.addPhotoToSelection(null)})},function(e){n.error("Error getting view",{err:e})})},loadSetsPhotoList:function(e){var t=this,r=this.get("container"),o;this.photoListView&&this.photoListView.destroy(),o={modelParams:e,parentName:this.name,paginateOnScroll:!0,parentContainer:r.one(".photo-selector-photos-wrapper"),relayoutOnResize:!0,interactionViewName:this.get("setsInteractionViewName"),engagementModelName:"set-models",viewBeaconRestrictedAttribute:"primaryNeedsInterstitial"},o.layout={targetRowHeight:i,containerWidth:o.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:20,bottom:10,left:20},itemSpacing:s,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:r.one(".photo-selector-photos-wrapper").get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=o,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:o,isActiveViewAgnostic:!0,container:r.one(".photo-selector-photos-container")}).then(function(e){return e.initialize().then(function(e){var n,i=r.one(".loader"),s=r.one(".photo-selector-photos-container .photo-list-view");r.one(".photo-selector-photos-wrapper").getDOMNode().scrollTop=0,t.photoListView=e,i&&r.one(".loader").addClass("loaded"),t.addPhotoToSelection(null)})},function(e){n.error("Error getting view",{err:e})})},loadSearchPhotoList:function(e){var t=this,i=this.get("container"),o,u=e.photoListContainerSelector?i.one(e.photoListContainerSelector):i.one(".photo-selector-photos-container"),a=e.parentContainerSelector?i.one(e.parentContainerSelector):i.one(".photo-selector-photos-wrapper"),f=e.maxNumRows?this.get("limitedRowsPhotoListViewName"):this.get("photoListViewName");this.searchPhotoListViews&&this.searchPhotoListViews[e.listId]&&this.searchPhotoListViews[e.listId].destroy(),o={modelParams:e.modelParams,parentName:this.name,paginateOnScroll:!0,parentContainer:a,relayoutOnResize:!0,interactionViewName:this.get("interactionViewName"),engagementModelName:"photo-lite-models"},this.get("itemFilterFunction")&&(o.itemFilterFunction=this.get("itemFilterFunction")),o.layout={targetRowHeight:r,containerWidth:o.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:0,bottom:10,left:0},itemSpacing:s,forceAspectRatio:1,maxNumRows:e.maxNumRows?e.maxNumRows:Number.POSITIVE_INFINITY,alwaysDisplayOrphans:e.alwaysDisplayOrphans?e.alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:a.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=o,this.appContext.getView(f,{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:o,isActiveViewAgnostic:!0,container:u,searchUrl:e.searchUrl,listId:e.listId}).then(function(n){return n.initialize().then(function(n){t.registerEventHandler(n.on("subviewViewEvent",t.handleSubviewEvent,t)),i.one(".photo-selector-search-lists-wrapper").getDOMNode().scrollTop=0,e.parentContainerSelector&&(i.one(e.parentContainerSelector).getDOMNode().scrollTop=0),t.searchPhotoListViews[e.listId]=n,i.one(".loader").addClass("loaded"),t.addPhotoToSelection(null)})},function(e){n.error("Error getting view",{err:e})})},activate:function(){var t=this.get("container"),n,r=this.get("defaultSelected");return this.registerEventHandler(t.on("click",this.handleClick,this)),this.get("hasUploadCapabilities")&&this.registerEventHandler(t.one(".file-select").on("change",this.handleFileSelect,this)),this.registerEventHandler(e.on("photoSelector:subviewEvent",this.handleSubviewEvent,this)),r?r.type==="group"?(n={registryName:"group-pool-models",modelIdOrAttributes:this.get("groupId")+"-public",collectionAttributeName:"photoPageList"},this.publicOnlyGroups&&(n.fetchParams={privacyFilter:1},n.modelIdOrAttributes+="-public"),this.toggleGroupSelector(),this.loadGroupPhotoList(n),this.toggleTitleBar(r.title,"group")):(n={registryName:"set-models",modelIdOrAttributes:r.id,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(n.fetchParams={filter:1}),this.loadPhotoList(n),this.toggleTitleBar(r.title,"set")):this.get("photostreamModel").getValue("totalItems")===0?this.get("hasUploadCapabilities")?(this.toggleUploader(),this.hideTitleBar()):this.toggleTitleBar(this.intlMessage({intlName:"common.PHOTO_SELECTOR_EMPTY_PUBLIC_PHOTOS"},"empty",!1)):(n={registryName:"photostream-models",modelIdOrAttributes:this.appContext.getViewer().nsid,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(n.fetchParams={viewAs:"public"}),this.loadPhotoList(n,!1)),this},toggleUploader:function(){this.get("hasUploadCapabilities")&&(this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("container").one(".photo-selector-photos-container").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-upload"
).removeClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding"))},toggleSelector:function(){this.get("hasUploadCapabilities")&&this.get("container").one(".photo-selector-upload").addClass("is-hiding"),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").removeClass("is-hiding")},toggleSearchListsSelector:function(){this.get("hasUploadCapabilities")&&this.get("container").one(".photo-selector-upload").addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("container").one(".photo-selector-photos-container").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".photo-selector-search-lists-wrapper").removeClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding")},toggleGroupSelector:function(){var e=this.get("container").one(".photo-selector-upload");e&&e.addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").removeClass("is-hiding")},toggleTitleBar:function(t,n,r){var i=this.get("container"),s=i.one(".photo-selector-title-bar"),o=s.one(".back-to-list"),u="";typeof r=="undefined"&&(r=!0),n==="search"&&t&&(t='"'+t+'"'),n==="set"?u=this.intlMessage({intlName:"common.PHOTO_SELECTOR_BACK_TO_ALBUM_LIST"}):n==="search"&&(u=this.intlMessage({intlName:"common.PHOTO_SELECTOR_BACK_TO_SEARCH_LIST"})),r?o.removeClass("hidden"):o.addClass("hidden"),o.set("text",u),s.one(".title").set("text",e.Handlebars.helpers.truncate(t,120)),s.removeClass("hidden"),i.one(".photo-selector-photos-wrapper").addClass("showing-title"),i.one(".photo-selector-search-lists-wrapper").addClass("showing-title"),this.get("groupId")&&i.one(".group-photo-selector-photos-wrapper").addClass("showing-title")},hideTitleBar:function(){var e=this.get("container"),t=e.one(".photo-selector-title-bar");t.addClass("hidden"),e.one(".photo-selector-photos-wrapper").removeClass("showing-title"),this.get("groupId")&&e.one(".group-photo-selector-photos-wrapper").removeClass("showing-title")},onParentViewEvent:function(t,n){var r=n[1],i,s,o={},u=this.get("searchable"),a=this.get("container").one(".no-results"),f;if(n[0]==="navigation"){i=r.target._node.dataset.value;if(i==="upload")this.get("hasUploadCapabilities")&&(this.toggleUploader(),this.hideTitleBar()),this.get("fileDragDrop")?this.get("fileDragDrop").reset():(this.set("fileDragDrop",new e.HtmlFileDragDrop({dropZone:".photo-selector-upload > .drop-zone"})),this.get("fileDragDrop").on("drop",this.handleFileDrop,this));else{this.get("hasUploadCapabilities")&&this.toggleSelector();if(i==="group")s={registryName:"group-pool-models",modelIdOrAttributes:this.get("groupId"),collectionAttributeName:"photoPageList"},this.publicOnlyGroups&&(s.fetchParams={privacyFilter:1},s.modelIdOrAttributes+="-public"),this.toggleGroupSelector(),this.loadGroupPhotoList(s);else if(i==="photostream"){if(this.get("photostreamModel").getValue("totalItems")===0){a&&a.remove(),this.get("hasUploadCapabilities")?(this.toggleUploader(),this.hideTitleBar()):this.toggleTitleBar(this.intlMessage({intlName:"common.PHOTO_SELECTOR_EMPTY_PUBLIC_PHOTOS"},"empty",!1));return}s={registryName:"photostream-models",modelIdOrAttributes:this.appContext.getViewer().nsid,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(s.fetchParams={viewAs:"public"}),this.loadPhotoList(s)}else if(i==="sets"){if(this.get("setsModel").getValue("totalItems")===0){a&&a.remove(),this.toggleTitleBar(this.intlMessage({intlName:"common.PHOTO_SELECTOR_NO_ALBUMS"},"empty",!1));return}s={registryName:"sets-models",modelIdOrAttributes:this.appContext.getViewer().nsid,collectionAttributeName:"albumsList"},this.loadSetsPhotoList(s)}else this.loadSelectionPhotoList();this.hideTitleBar()}}else n[0]==="search"&&(f=new e.SearchUrl(r.apiParams,this.appContext),this.toggleSearchListsSelector(),u.yours&&(this.searchUrlYourPhotos=new e.SearchUrl(r.apiParams,this.appContext),this.searchUrlYourPhotos.setAPIParam("user_id",this.appContext.getViewer().nsid),!u.contacts&&!u.everyone?(this.toggleSelector(),s={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlYourPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlYourPhotos.getAPIParams(),additionalExtras:["o_dims","is_marketplace_printable","has_invalid_colorspace_for_print"]}},this.publicOnlyPhotos&&(s.fetchParams.privacyFilter=1),this.loadPhotoList(s,!0)):(o.listId="yours",o.photoListContainerSelector=".photo-selector-search-list-yours .photo-selector-search-list-container",o.parentContainerSelector=".photo-selector-search-list-yours",o.maxNumRows=1,o.alwaysDisplayOrphans=!0,o.searchUrl=this.searchUrlYourPhotos,o.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlYourPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlYourPhotos.getAPIParams()}},this.publicOnlyPhotos&&(s.fetchParams.privacyFilter=1),this.loadSearchPhotoList(o))),u.contacts&&(this.searchUrlContactsPhotos=new e.SearchUrl(r.apiParams,this.appContext),this.searchUrlContactsPhotos.setAPIParam("user_id",this.appContext.getViewer().nsid),this.searchUrlContactsPhotos.setAPIParam("contacts","all"),o.listId="contacts",o.photoListContainerSelector=".photo-selector-search-list-contacts .photo-selector-search-list-container"
,o.parentContainerSelector=".photo-selector-search-list-contacts",o.maxNumRows=1,o.alwaysDisplayOrphans=!0,o.searchUrl=this.searchUrlContactsPhotos,o.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlContactsPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlContactsPhotos.getAPIParams()}},this.loadSearchPhotoList(o)),u.everyone&&(this.searchUrlEveryonePhotos=new e.SearchUrl(r.apiParams,this.appContext),o.listId="everyone",o.photoListContainerSelector=".photo-selector-search-list-everyone .photo-selector-search-list-container",o.parentContainerSelector=".photo-selector-search-list-everyone",o.maxNumRows=1,o.alwaysDisplayOrphans=!0,o.searchUrl=this.searchUrlEveryonePhotos,o.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:r.id,collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlEveryonePhotos.getAPIParams()}},this.loadSearchPhotoList(o)),this.toggleTitleBar(f.getAPIParams().text,"search",!1))},handleSubviewEvent:function(t){var n,r,i;if(t.eventName==="selectPhotoFromPhotoList")return n={photoModel:this.appContext.getModel("photo-models",t.id)},(new e.FlickrPromise(n)).then(function(e){e.photoModel.isOwner&&this.set("photoSource",this.get("photoSourceOwnImage"));if(this.enableMultiSelect&&this.hasReachMultiSelectLimit())return;this.addPhotoToSelection(e.photoModel.id,e.photoModel)}.bind(this));if(t.eventName==="unselectPhotoFromPhotoList")return n={photoModel:this.appContext.getModel("photo-models",t.id)},(new e.FlickrPromise(n)).then(function(e){e.photoModel.isOwner&&this.set("photoSource",this.get("photoSourceOwnImage")),this.removePhotoFromSelection(e.photoModel.id,e.photoModel)}.bind(this));if(t.eventName==="selection:remove")return n={photoModel:this.appContext.getModel("photo-models",t.model.getValue("id"))},(new e.FlickrPromise(n)).then(function(e){e.photoModel.isOwner&&this.set("photoSource",this.get("photoSourceOwnImage")),this.removePhotoFromSelection(e.photoModel.id,e.photoModel,!0)}.bind(this));t.eventName==="selectSetFromPhotoList"?(this.publicOnlyPhotos&&this.get("setModelRegistry").remove(t.id),r={registryName:"set-models",modelIdOrAttributes:t.id,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(r.fetchParams={filter:1}),this.loadPhotoList(r,!1),this.toggleTitleBar(t.title,"set")):t.details&&t.details[0]==="viewEntireSearchList"&&(r={registryName:"search-photos-lite-models",modelIdOrAttributes:t.details[1].searchUrl.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:t.details[1].searchUrl.getAPIParams()}},this.publicOnlyPhotos&&(r.fetchParams.privacyFilter=1),this.toggleSelector(),this.loadPhotoList(r),i="search.YOUR_PHOTOS",t.details[1].list==="contacts"?i="search.FROM_YOUR_CONTACTS":t.details[1].list==="everyone"&&(i="search.EVERYONES_PHOTOS"),i=this.intlMessage({intlName:i}),this.toggleTitleBar(i+": "+t.details[1].searchUrl.getAPIParams().text,"search"))},handleClick:function(e){var t=e.target,n,r;if(this.isUploading)return;t.hasClass("back-to-list")?this.fire("subviewViewEvent","backToList"):t.hasClass("simulate-file-select")&&(e.halt(),this.get("container").one(".file-select").set("value",""),this.get("container").one(".file-select").getDOMNode().click())},handleSelectPhoto:function(t){var n;n={photoModel:this.appContext.getModel("photo-models",t.getData("photo-id"))};if(t.hasClass("invalid"))return;return this.set("photoSource",this.get("photoSourceOwnImage")),(new e.FlickrPromise(n)).then(function(e){this.addPhotoToSelection(e.photoModel.id,e.photoModel)}.bind(this))},hasReachMultiSelectLimit:function(){return this.get("selectionModel").getValue("photos").size()===this.multiSelectLimit},addPhotoToSelection:function(t,n){if(t===null)this.set("selected",null),e.fire("photoSelector:unselected");else if(t&&this.enableMultiSelect){var r=this.get("selectionModel").getValue("photos");this.hasReachMultiSelectLimit()||r.find(n)||(r.push(n),e.fire("photoSelector:selected",{hasWarning:!1,photoId:t}),this.updateSelectCountText(r.size()))}else t&&(this.set("selected",t),e.fire("photoSelector:selected",{hasWarning:!1,photoId:t}))},updateSelectCountText:function(t){var n=e.one(".profile-showcase-selector .flavor-text");n&&n.setHTML(this.intlMessage({intlName:"profile.CHOOSE_UP_TO_PHOTOS",limit:this.multiSelectLimit-t}))},removePhotoFromSelection:function(t,n,r){var i=this.get("selectionModel").getValue("photos");if(i.find(n)){var s=i.removeFromList(t);s&&(e.fire("photoSelector:unselected",{hasWarning:!1,photoId:t,wasLastPhotoSelected:i.size()===0}),this.updateSelectCountText(i.size()),r&&this.loadSelectionPhotoList())}},handlePhotoSetSelector:function(e){var t;this.get("hasUploadCapabilities")&&this.toggleSelector(),t={registryName:"set-models",modelIdOrAttributes:e,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(t.fetchParams={filter:1}),this.loadPhotoList(t)},handlePhotoUploaded:function(e){this.appContext.getModelRegistry("photostream-models").then(function(t){t.attributeSearch({normalizedId:this.appContext.getViewer().nsid},!0).forEach(function(e){t.remove(e)}),this.addPhotoToSelection(e.id,e),this.fire("actionClick",e),this.resetUploader()}.bind(this),function(e){this.appContext.err(e)}.bind(this))},handleFileSelect:function(e){var t;t=e.target.getDOMNode().files[0],t&&t.name&&this.uploadFile(t)},pollTicket:function(t){var n;if(!this.uploadTimer)this.uploadTimer=e.moment();else{n=e.moment().diff(this.uploadTimer,"seconds");if(n>this.get("maxUploadTimeAllowed"))return this.showUploadError("GENERIC")}this.appContext.callAPI("flickr.photos.upload.checkTickets",{tickets:t}).then(function(e){var n;e&&e.stat&&(e.stat!=="ok"&&this.showUploadError("GENERIC"),e.uploader&&e.uploader.ticket instanceof Array&&(n=e.uploader.ticket[0],n&&n.id===t&&(n.complete===1?this.appContext.getModel("photo-models",n.photoid).then(this.handlePhotoUploaded.bind(this),function(e){this.showUploadError("GENERIC")}):n.complete===2?this.showUploadError("FILE_TYPE"
):setTimeout(function(){this.pollTicket(t)}.bind(this),1e3))))}.bind(this),function(e){this.showUploadError("GENERIC")}.bind(this))},resetUploader:function(){this.clearUploadError(),this.get("container").one(".drop-zone").removeClass("uploading"),this.get("container").removeClass("uploading"),this.isUploading=!1,this.uploadTimer=undefined},uploadFile:function(t){var r=new FormData,i,s=e.config.flickr.api.hostname_client_upload,o,u;this.clearUploadError(),this.get("container").one(".drop-zone").addClass("uploading"),this.get("container").addClass("uploading"),this.isUploading=!0,r.append("api_key",e.config.flickr.api.site_key),r.append("csrf",e.config.flickr.csrf.token),r.append("photo",t,t.name),r.append("async","1"),r.append("is_public","0"),r.append("is_friend","0"),r.append("is_family","0"),r.append("content_type","1"),i=this._imgFileXhr=new XMLHttpRequest,i.open("POST",s,!0),i.withCredentials=!0,o=function(e){var t=typeof e=="object"?e.target.statusText:e+"";n.error("Error during upload",{statusText:t}),this.resetUploader(),this.showUploadError("GENERIC")},u=function(t){var n,r,i,s;try{s=e.one(t.currentTarget.responseXML),r=s.one("rsp").getAttribute("stat")}catch(u){r="",n=""}return r!=="ok"?o((r||"empty")+": "+(n||"no message")):(i=s.one("ticketid").get("text"),this.pollTicket(i))},i.addEventListener("load",u.bind(this)),i.addEventListener("error",o.bind(this)),i.send(r)},clearUploadError:function(){this.get("container").one(".upload-error").setHTML("")},showUploadError:function(e){this.resetUploader(),this.get("container").one(".upload-error").setHTML(this.intlMessage({intlName:this.get("errorMessages")[e]})),this.get("fileDragDrop").showError()},handleFileDrop:function(e){if(this.isUploading)return;e instanceof Error?this.showUploadError(e.message):this.uploadFile(e)},destructor:function(){this.photoListView&&this.photoListView.destroy()}},{ATTRS:{maxUploadTimeAllowed:{readOnly:!0,value:20},errorMessages:{readOnly:!0,value:{GENERIC:"common.PHOTO_SELECTOR_ERROR_MESSAGE_GENERIC",FILE_TYPE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_TYPE",FILE_SIZE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_SIZE",FILE_COUNT:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_COUNT",LOW_QUALITY:"common.PHOTO_SELECTOR_ERROR_MESSAGE_LOW_QUALITY",COLOR_SPACE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_COLOR_SPACE"}},photoSourceOwnImage:{readOnly:!0,value:1},hasUploadCapabilities:{value:!0},photoListViewName:{value:"photo-selector-photolist-view"},limitedRowsPhotoListViewName:{value:"photo-selector-limited-rows-photolist-view"},searchable:{value:{yours:!0,contacts:!0,everyone:!0}},interactionViewName:{value:"photo-selector-photolist-interaction-view"},setsInteractionViewName:{value:"photo-selector-sets-photolist-interaction-view"},itemFilterFunction:{value:function(e){return!e.getValue("isVideo")}},defaultSelected:{value:!1},selected:{},groupId:{}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","flickr-api","html-file-dragdrop","hermes-template-photo-selector","photo-selector-photolist-view","photo-selector-limited-rows-photolist-view","photo-selector-photolist-interaction-view","photo-selector-sets-photolist-interaction-view"],optional:["search-photos-lite-models"],langBundles:["common","wallart","search","groups","profile"]});
YUI.add("hermes-lang-wallart",function(e,t){e.Intl.add("hermes/wallart","en-US",{WALL_ART:["Wall Art"],YOU_CANCELLED_THIS_ITEM_ON_DATE:["You cancelled this item order on ",{type:"date",valueName:"date",format:"monthYear"}],YOU_ORDERED_THIS_ITEM_ON_DATE:["You ordered this item on ",{type:"date",valueName:"date",format:"monthYear"}],RETURN_TO_YOUR_ORDER_HISTORY:["Return to your order history"],SELECT_A_PHOTO:["Select a photo"],SELECT_PRODUCT:["Select product"],PHOTO_MOUNT:["Photo Mount"],CANVAS:["Canvas"],CANVAS_WRAP:["Canvas Wrap"],PREMIUM_LUSTRE:["Premium Lustre"],GLOSSY:["Glossy"],MATTE:["Matte"],SIZE:["Size"],CHECKOUT:["Checkout"],REORDER:["Reorder"],TOTAL:["Total"],UPLOAD:["Upload"],CURATED_COLLECTIONS:["Curated Collections"],CREATIVE_COMMONS:["Creative Commons"],NASA:["NASA"],ABSTRACT:["Abstract"],ANIMALS:["Animals"],PATTERNS:["Patterns"],FOOD:["Food"],LANDSCAPES:["Landscapes"],TRAVEL:["Travel"],MY_ALBUMS:["My Albums"],PRODUCT_DROPUP_CANVAS:['Artist-grade canvas wrapped around 1.25" wood frame'],PRODUCT_DROPUP_MOUNTED:['Archival photo paper finished with 1" wood-textured edge'],MATERIAL_DROPUP_LUSTRE:["Professional Crystal Archive - Premium Lustre"],MATERIAL_DROPUP_GLOSSY:["Professional Crystal Archive - Glossy"],MATERIAL_DROPUP_MATTE:["Professional Crystal Archive - Matte"],SIZES_MODAL_SIZES_NOT_AVAILABLE:["Some sizes not available due to the resolution of the photo. Learn More."],MOUNTED_SAFE_AREA:["The area outside of the solid-line will not be printed. <br>Inside the line is the safe area."],CANVAS_SAFE_AREA:["The area outside of the dotted-line will be printed on the wrap. <br>Inside the line will be printed on the front."],SAVING:["Saving..."],SAVED:["All changes saved"],WITH_CODE:["with code:"],FREE_SHIPPING_WITH_CODE:["Free shipping with code:"],PRODUCT_DESCRIPTION_CANVAS_PART_1_8X10:['8" x 10" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_10X8:['10" x 8" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_12X12:['12" x 12" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_11X14:['11" x 14" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_14X11:['14" x 11" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_16X20:['16" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X16:['20" x 16" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X24:['20" x 24" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_24X20:['24" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X30:['20" x 30" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_30X20:['30" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_2:['1.25" stretcher bars<br>Impact resistant frame<br>Includes hardware to hang'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_8X10:['8" x 10" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_10X8:['10" x 8" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_12X12:['12" x 12" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_11X14:['11" x 14" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_14X11:['14" x 11" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_16X20:['16" x 20" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X16:['20" x 16" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X30:['20" x 30" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_30X20:['30" x 20" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE:['Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY:['Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE:['Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND:['Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND:['Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND:['Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PHOTO_TOO_SMALL_IN_SELECTED_SIZE:['This photo is too small to print in your selected size. We\'ll automatically find the next best size for you. <a href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567">Learn more.</a>'],BAD_SIZES:['Some sizes not available due to the resolution of the photo. <a target="_blank" href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567">Learn More</a>'],NOT_AVAILABLE:["Not available due to photo resolution"],UPLOADR_ERROR_MESSAGE_GENERIC:["There was a problem uploading your photo. Please try again."],UPLOADR_ERROR_MESSAGE_FILE_TYPE:["Looks like this photo has an invalid file type. Upload a photo that is either a PNG or JPG."],UPLOADR_ERROR_MESSAGE_FILE_SIZE:["Looks like this photo is too large to upload. The largest photo size we can upload is 250 MB."],UPLOADR_ERROR_MESSAGE_FILE_COUNT:["Select only one photo to upload."],UPLOADR_ERROR_MESSAGE_LOW_QUALITY:['Looks like this photo doesn\'t meet the minimum requirements to get printed. Please choose a photo that\'s at least 975 &times; 825 pixels. Learn more about <a href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567" target="_blank">requirements</a> for print products.'],UPLOADR_ERROR_MESSAGE_COLOR_SPACE:['Sorry, we cannot print photos with a CMYK or ProPhoto RGB colorspace. We recommend photos with an sRGB color space. <a href="https://help.yahoo.com/kb/flickr/creations-faq-sln22216.html?impressions=true#cont33" target="_blank">Learn more</a>.'],DRAG_DROP_TO_UPLOAD:['Drag and drop your photo to upload or <a href="#" class="simulate-file-select">browse</a>.'],PHOTOS_UPLOADED_AS_PRIVATE:['Photos uploaded here will be added to your <a href="/me/">Photostream</a> as private.'],LOW_QUALITY_ZOOM_HANDLE_TOOLTIP_CANVAS:["At this zoom level, your photo will print at a low quality. Please zoom out to purchase."
],LOW_QUALITY_ZOOM_HANDLE_TOOLTIP_MOUNTED:["At this zoom level, your photo will print at a low quality. Please zoom out to purchase."],INITIAL_DIALOG_CANVAS_DISABLED:["Canvas Wrap is not available for this photo due to its low resolution. Canvas Wrap requires a minimum 975px x 825px."],INITIAL_DIALOG_MOUNTED_DISABLED:["Photo Mount is not available for this photo due to its low resolution. Photo Mount requires a minimum 1000px x 800px."],GO_BACK:["Go back"],PHOTO_NOT_LARGE_ENOUGH_TO_ROTATE:["This photo is not large enough to rotate into a different orientation."],CHANGE_SIZE:["Change size"],CHANGE_PHOTO:["Change photo"],CREATIONS:["Creations"],VIEW_ORDER_HISTORY:["View order history"],COMPLETED:["Completed"],IN_PROGRESS:["In progress"],CREATE_NEW:["Create new"],CREATIONS_EMPTY_WALLART:["No Wall Art to show"],CREATIONS_EMPTY_BOOKS:["No Photo Books to show"],CREATIONS_EMPTY_TERTIARY:['We\'ll display in progress and completed creations here.<br>Learn more about <a href="/create" title="">Wall Art</a> and <a href="/create" title="">Photo Books</a>.'],CREATIONS_NOT_ABLE_DELETE:["We were not able to delete this creation. Please try again later."],PHOTO_FOR_WALLART_DELETED:["The photo for this wall art was deleted"],DELETE_THIS_WALLART:["Delete this wall art"],REORDER_THIS_WALLART:["Reorder this wall art"],EDIT_THIS_WALLART:["Edit this wall art"],CHANGE_PAPER:["Change paper"],MATERIAL_DROPUP_LUSTRE_NEW:['Lustre\'s pearl-like finish gives your photo a "true-to-life" look. It provides the color saturation of glossy but the fingerprint resistance of matte.'],MATERIAL_DROPUP_GLOSSY_NEW:["A sleek, glossy finish with high-contrast appearance so your photos appear crisp and sharp. Great for highly reflective photos of water, metal or sky."],MATERIAL_DROPUP_MATTE_NEW:["An elegant, matte finish with lower contrast to enhance the texture of your photo. Resists fingerprints and is great for black and white photos."],ON_SALE:["On Sale"],PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW:['<span>1.25" stretcher bars</span><span>Impact resistant frame</span><span>Includes hardware to hang</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_PREVIEW:['<span>Matte finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_PREVIEW:['<span>Glossy finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_PREVIEW:['<span>Premium lustre finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND_PREVIEW:['<span>Matte finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND_PREVIEW:['<span>Glossy finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND_PREVIEW:['<span>Premium lustre finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PHOTO_BOOK:["Photo Book"],GLOSSY_HARDCOVER_BOOK_PREMIUM_LUSTRE_PAPER:['11" x 8.5" glossy hardcover book with premium lustre paper'],LOW_QUALITY_WARNING:["This photo cannot be printed because the resolution is too low."],INVALID_COLORSPACE_WARNING:["This photo cannot be printed because it uses a colorspace that is not supported."],LOW_QUALITY_TYPE_WARNING:["This photo cannot be printed with this type of wallart because the resolution is too low."],NO_COMPLETED_ORDER:["No completed orders."]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-fluid-modal-nav-bar",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return(s=n.unless.call(t!=null?t:{},t!=null?t.disabled:t,{name:"unless",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:""},2:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'			<li data-id="'+l((o=(o=n.id||(t!=null?t.id:t))!=null?o:a,typeof o===f?o.call(u,{name:"id",hash:{},data:i}):o))+'" data-value="'+l((o=(o=n.value||(t!=null?t.value:t))!=null?o:a,typeof o===f?o.call(u,{name:"value",hash:{},data:i}):o))+'" class="link '+((s=n["if"].call(u,t!=null?t.selected:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+" "+((s=n["if"].call(u,t!=null?t.hiddenByDefault:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"><a data-value="'+l((o=(o=n.value||(t!=null?t.value:t))!=null?o:a,typeof o===f?o.call(u,{name:"value",hash:{},data:i}):o))+'">'+l((o=(o=n.name||(t!=null?t.name:t))!=null?o:a,typeof o===f?o.call(u,{name:"name",hash:{},data:i}):o))+"</a></li>\n"},3:function(e,t,n,r,i){return"selected"},5:function(e,t,n,r,i){return"hidden"},7:function(e,t,n,r,i){return'			<form action="/search" method="get" role="search">\n				<input type="text" name="text" value="" class="search-field" autocomplete="off" aria-label="Search" role="textbox">\n				<input type="submit" class="search-icon" tabindex="-1" aria-label="Search" role="button">\n			</form>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{};return'<div class="fluid-modal-nav-bar">\n	<div class="fluid-modal-nav-content">\n		<ul class="links">\n'+((s=n.each.call(o,t!=null?t.links:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"		</ul>\n"+((s=n["if"].call(o,t!=null?t.enableSearch:t,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i}))!=null?s:"")+"	</div>\n</div>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-modal-nav-bar",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-modal-nav-bar-view",function(e){"use strict";var t;t={css:{nav:".fluid-modal-nav-bar",navContent:".fluid-modal-nav-content",links:".links",link:".link"},options:{}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},loadState:function(){return this},buildContainer:function(){var e;return e={links:this.get("links"),enableSearch:this.get("enableSearch")},this.setContainerWithTemplate("fluid-modal-nav-bar",e),this},activate:function(){var e=this.get("container"),t=this;return this.registerEventHandler(e.on("click",this.handleClick.bind(this))),this.get("links").forEach(function(n){n.selected&&t.set("currentSelection",e.one('.link[data-id="'+n.id+'"]'))}),this},deselectAll:function(){var e=this.get("container"),n=e.one(t.css.nav),r=n.one(t.css.navContent),i=r.one(t.css.links);i.all(t.css.link).removeClass("selected")},handleClick:function(t){t.halt();var n=t.target,r=n.get("parentNode"),i=this.get("container"),s,o={},u=this.appContext.getViewer().nsid;n.getDOMNode().tagName.toLowerCase()==="a"?(this.deselectAll(),r.addClass("selected"),this.set("currentSelection",r),i.one(".search-field").getDOMNode().value="",this.fire("subviewViewEvent","navigation",t)):n.hasClass("link")?(this.deselectAll(),n.addClass("selected"),this.set("currentSelection",n),i.one(".search-field").getDOMNode().value="",this.fire("subviewViewEvent","navigation",t)):this.get("enableSearch")&&(s=i.one(".search-field").getDOMNode(),n.getDOMNode().type==="submit"&&(o.apiParams={},o.apiParams[e.AttributeHelpers.coerceString(s.name)]=s.value,o.id=e.SearchHelper.generateQueryString(o.apiParams)||e.guid(),o.viewerNsid=u,this.fire("subviewViewEvent","search",o),this.deselectAll(),this.set("currentSelection",{type:"search",modelParams:o})))},onParentViewEvent:function(t,n){var r=this.get("currentSelection");n[0]==="backToList"&&(r instanceof e.Node?this.get("currentSelection").getDOMNode().click():r.type==="search"&&this.fire("subviewViewEvent","search",r.modelParams))}},{ATTRS:{links:{value:[],validator:function(t){return e.Lang.isArray(t)}},currentSelection:{value:null},enableSearch:{value:!0,validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-fluid-modal-nav-bar","attribute-helpers","search-helper"],langBundles:["common","wallart"],optional:["person-models","photo-models"]});
YUI.add("fluid-coverphoto-editor",function(e){"use strict";var t=768,n=2048,r;r={dragging:{mouseDownY:0,previousY:0},potential:{y:0,height:0,width:0,url:"",id:0,aspectRatio:0},original:{width:0,height:0,url:""}},e.FluidCoverPhotoEditor=function(e){this.coverPhotoElement=e,r.original.url=e.getStyle("backgroundImage")},e.FluidCoverPhotoEditor.prototype.loadCoverPhoto=function(t){var n=new Image,i=this,s,o,u;return new e.Promise(function(e,a){n.onload=function(){u=i._determineBoundaries(r.potential.height,r.potential.width),i.coverPhotoElement.setStyles({backgroundImage:"url("+n.src+")",backgroundPosition:"50% "+u.min*-1+"px"}),i.coverPhotoElement.addClass("editing"),i.setupEditorHandlers(),e()},r.potential.id=t.id,o=t.getValue("descendingSizes")[0],s=t.getValue("descendingSizes")[1],r.potential.width=s.width,r.potential.height=s.height,r.potential.url=s.url,r.original.width=o.width,r.original.height=o.height,r.potential.aspectRatio=t.getValue("aspectRatio"),n.src=s.url})},e.FluidCoverPhotoEditor.prototype._convertYPositionForApi=function(e,i){var s=parseInt(this.coverPhotoElement.get("offsetHeight"),10),o=parseInt(this.coverPhotoElement.get("offsetWidth"),10),u,a,f,l;return r.potential.aspectRatio!==r.original.width/r.original.height&&(i=r.original.height),u=Math.abs(e)+s/2,a=u*n/o,f=a-t/2,l=f*i/n,l},e.FluidCoverPhotoEditor.prototype._determineBoundaries=function(e,r){var i=parseInt(this.coverPhotoElement.get("offsetWidth"),10),s=parseInt(this.coverPhotoElement.get("offsetHeight"),10),o,u,a,f,l,c;return o=i*e/r,u=t/2,f=u*i/n,a=f-s/2,l=o-a,c=l-s,{min:a,max:c}},e.FluidCoverPhotoEditor.prototype.setupEditorHandlers=function(){var t=this,n=this._determineBoundaries(r.potential.height,r.potential.width);e.one(e.config.win.document.documentElement).addClass("disable-text-select"),this.coverPhotoElement.on("mousedown",function(e){e.halt();var n=t.coverPhotoElement.getStyle("backgroundPosition").split(" "),i=n.length===2?parseInt(n[1],10):0;r.dragging.mouseDownY=e.pageY,r.dragging.previousY=i,r.dragging.startDrag=!0,t.coverPhotoElement.addClass("grabbing")}),this.coverPhotoElement.on("mouseup",function(){r.dragging.startDrag=!1,t.coverPhotoElement.removeClass("grabbing")}),this.coverPhotoElement.on("mouseout",function(){r.dragging.startDrag=!1,t.coverPhotoElement.removeClass("grabbing")}),this.coverPhotoElement.on("mousemove",function(e){e.halt();if(!r.dragging.startDrag)return;var i=r.dragging.mouseDownY-e.pageY,s=r.dragging.previousY-i,o=n.min*-1,u=n.max*-1;s=s>=u?s:u,s=s>o?o:s,r.potential.y=s,t.coverPhotoElement.setStyle("backgroundPosition","50% "+s+"px")})},e.FluidCoverPhotoEditor.prototype.cancelCoverPhotoEditing=function(){this.coverPhotoElement.removeClass("editing"),this.coverPhotoElement.setStyles({backgroundImage:r.original.url,backgroundPosition:"50% 50%"}),this.coverPhotoElement.detachAll(),e.one(e.config.win.document.documentElement).removeClass("disable-text-select")},e.FluidCoverPhotoEditor.prototype.saveCoverPhoto=function(t){var n=this._convertYPositionForApi(r.potential.y,r.original.width),i={photo_id:r.potential.id,y:n},s;t&&(i.group_id=t,s="group"),this.coverPhotoElement.addClass("saving"),e.coverPhotoSaver.save(i,s).then(function(){e.config.win.location.reload()})}},"@VERSION@",{affinity:"",requires:["flickr-promise","event-custom"]});
YUI.add("coverphoto-saver",function(e){"use strict";e.coverPhotoSaver={methods:{photostream:"flickr.coverphoto.setAccountCover",group:"flickr.coverphoto.setGroupCover"},save:function(t,n){var r=e.config.win.appContext,i={group_id:t.group_id,photo_id:t.photo_id,x:Math.abs(t.x||0),y:Math.abs(t.y||0)},s=this.methods[n||"photostream"];return new e.Promise(function(e,t){r.callAPI(s,i).then(function(n){var i=0,s=5,o=2e3,u=function(){r.callAPI("flickr.photos.upload.checkTickets",{tickets:n.coverphoto.ticketId}).then(function(n){var r=n&&n.uploader.ticket[0];i++,r&&r.complete===1?e():i>s?t():setTimeout(u,o)})};n&&n.coverphoto&&n.coverphoto.ticketId&&setTimeout(u,o)},function(e){t(new Error("Cover photo could not be saved."))})})}}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("avatar-saver",function(e){"use strict";e.AvatarSaver={methods:{people:"flickr.people.setBuddyIcon",group:"flickr.groups.setBuddyIcon"},save:function(t,n){var r=e.config.win.appContext,i=this.methods[n||"people"];return new e.Promise(function(e,n){r.callAPI(i,t).then(function(t){var i=0,s=5,o=2e3,u=function(){r.callAPI("flickr.photos.upload.checkTickets",{tickets:t.ticketid.content}).then(function(t){var r=t&&t.uploader.ticket[0];i++,r&&r.complete===1?e():i>s?n():setTimeout(u,o)})};t&&t.ticketid&&setTimeout(u,o)},function(e){n(new Error("Cover photo could not be saved."))})})}}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("fluid-coverphoto-view",function(e,t){"use strict";var n=require("lib/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),e.nsid||(n.warn("did not receive an `nsid` param and will default to appContext getViewer() nsid."),e.nsid=this.appContext.getViewer().nsid),this.set("pageNsid",e.nsid),this.set("hasFollow",e.hasFollow),this.set("models",{}),this.set("viewingSelf",!1),this.set("viewerIsGod",!1),this.set("currentHeaderPath",e.currentHeaderPath),this.set("hideOptOutBanner",e.hideOptOutBanner),this},subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,isFluid:!0,isOnDark:!0,disabled:function(){return!this.get("hasFollow")}}},loadState:function(){return e.Promise.resolve()},getViewer:function(){var t=this.appContext.getViewer(),n=t&&t.signedIn&&t.nsid;return this.set("viewingSelf",n===this.get("pageNsid")),n&&this.set("viewerIsGod",t.isInsecureGod),e.Promise.resolve(null)},buildContainer:function(e){return e=e||{},e.viewingSelf=this.get("viewingSelf"),e.viewerIsGod=this.get("viewerIsGod"),e.isFullBleed=this.get("fullBleed"),e.csrf=this.appContext.auth.csrf?this.appContext.auth.csrf:"",e.hideOptOutBanner=this.get("hideOptOutBanner"),this.get("models").person&&this.appContext.flipper.isFlipped("enable-pro-badge")&&(e.isPro=this.get("models").person.getValue("isPro")),YUI.Env.isServer?e.pageUrl=this.appContext.request.url:e.pageUrl=window.location.pathname,e.iconMessage||(e.iconMessage=this.intlMessage({intlName:"header.CHANGE_YOUR_BUDDY_ICON"})),e.titleBlock&&e.titleBlock.follow&&this.subviews["follow-view"]&&(e.titleBlock.follow=this.subviews["follow-view"].get("container")),this.setContainerWithTemplate("fluid-coverphoto",e),this},buildPersonCoverPhoto:function(){var e=this.get("models").personProfile;return e?{coverPhoto:{urls:e.getValue("coverPhotoUrls"),canEdit:this.get("canEditCoverPhoto"),attribution:""}}:null},buildGroupCoverPhoto:function(){var e=this.get("models").groupInfo;return e?{coverPhoto:{urls:e.getValue("group").getValue("coverPhotoUrls"),canEdit:this.get("canEditCoverPhoto"),attribution:e.getValue("coverPhotoAttribution")}}:null},buildAvatar:function(){var t=this.get("models"),n=t&&this.get("models").person,r=n&&n.getValue("buddyicon"),i=n&&e.URLHelper.generatePersonUrls(n);return n?{avatar:{canEdit:this.get("viewingSelf"),editUrl:"/iconbuilder/",sendFlickrMail:i.sendFlickrMail,linkUrl:i.photostream,icon:{retina:r.retina||r.large||r.medium,lowres:r.default},type:""}}:null},buildTitleBlock:function(){return{titleBlock:null}},buildMetadata:function(){return{metadata:null}},activate:function(){return this.coverPhotoElement=this.get("container").one(".coverphoto"),this.FluidCoverPhotoEditor=new e.FluidCoverPhotoEditor(this.coverPhotoElement),this.get("canEditCoverPhoto")&&this.attachEvents({":pick":this.setupCoverPhotoEditor.bind(this),":cancelEdit":this.FluidCoverPhotoEditor.cancelCoverPhotoEditing.bind(this.FluidCoverPhotoEditor),":saveEdit":this.FluidCoverPhotoEditor.saveCoverPhoto.bind(this.FluidCoverPhotoEditor,this.groupId)}),this.get("container").one(".avatar .edit")&&this.attachEvents({":editAvatar":this.handleAvatarEditClick.bind(this)}),this},setupAvatarEditor:function(t){var r=this,i=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,noScroll:!0,hideModalOverlay:!1,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,width:Math.round(Math.max(1280,e.config.win.innerWidth)*.6),height:Math.round(e.config.win.innerHeight-60),title:this.intlMessage({intlName:"header.POSITION_IMAGE"}),actionButtonLabel:this.intlMessage({intlName:"common.SAVE"}),subview:new e.Views["fluid-avatar-editor-view"]({appContext:this.appContext,photoModel:t,contentHeight:Math.max(400,Math.round(e.config.win.innerHeight)*.6)})});i.on("actionClick",function(t){var i=this.get("subview").get("apiParams");r.groupId&&(i.group_id=r.groupId),r.get("container").one(".avatar").addClass("loading"),e.AvatarSaver.save(i,r.groupId?"group":null).then(function(){setTimeout(e.config.win.location.reload.bind(e.config.win.location),2e3)}).catch(function(e){n.error({err:e}),r.get("container").one(".avatar").removeClass("loading")})}),i.show()},handleAvatarEditClick:function(t){var n=this,r;t.halt();if(this.isMobile)return;return r=this.getPhotoSelector(),r.on("actionClick",function(e){var t=r.get("subview").get("selected");n.appContext.getModel("photo-models",t).then(function(e){r.close(),n.setupAvatarEditor(e)})}),r.registerEventHandler(e.on("photoSelector:selected",function(e){r.enableActionButton()})),r.registerEventHandler(e.on("photoSelector:unselected",function(e){r.disableActionButton()})),r.show(),r},setupCoverPhotoEditor:function(){var t=this,n;return n=this.getPhotoSelector({publicOnlyGroups:!0}),n.on("actionClick",function(e){var r=n.get("subview").get("selected");t.appContext.getModel("photo-models",r).then(function(e){t.FluidCoverPhotoEditor.loadCoverPhoto(e).then(function(){n.close()})})}),n.registerEventHandler(e.on("photoSelector:selected",function(e){n.enableActionButton()})),n.registerEventHandler(e.on("photoSelector:unselected",function(e){n.disableActionButton()})),n.show(),n},getPhotoSelector:function(t){var r=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],i={appContext:this.appContext,searchable:{yours:!0,contacts:!1,everyone:!1,marketplace:!1}},s;if(this.groupId){if(!this.get("models").group)return n.error("Missing group model");r=r.filter(function(e){return e.id!=="upload"}),s=this.intlMessage({intlName:"search.IN_GROUP_POOL",name:this.get("models").group.getValue("title")}),r[0].selected=!1,r.push({id:"group",name:this.intlMessage({intlName:"context.GROUP_CONTEXT_TITLE"}),value
:"group",selected:!0}),i.groupId=this.groupId,i.defaultSelected={id:this.groupId,title:s,type:"group"},t&&t.publicOnlyGroups&&(i.publicOnlyGroups=!0)}return new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!1,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:"",navBarView:new e.Views["fluid-modal-nav-bar-view"]({appContext:this.appContext,links:r,enableSearch:!0}),actionButtonLabel:this.intlMessage({intlName:"common.SELECT"}),actionButtonDisabled:!0,subview:new e.Views["photo-selector-view"](i),width:Math.round(Math.max(1280,e.config.win.innerWidth)*.8),minWidth:800,height:Math.round(e.config.win.innerHeight-60),fullWindow:!0,classList:"photo-selector",hideModalOverlay:!1})}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-fluid-coverphoto","hermes-template-flickr-balls","follow-view","fluid-avatar-editor-view","photo-selector-view","fluid-modal-nav-bar-view","fluid-modal-view","fluid-coverphoto-editor","coverphoto-saver","avatar-saver"],optional:["person-models","person-profile-models"],optionalRequires:["fluid"],langBundles:["header","common","global-nav","search","context"]});
YUI.add("hermes-lang-context",function(e,t){e.Intl.add("hermes/context","en-US",{CONTACTS_CONTEXT_TITLE:["Contacts"],CONTACTS_CONTEXT_TYPE:["contacts"],EXPLORE_CONTEXT_TITLE:["Explore"],EXPLORE_CONTEXT_TYPE:["explore"],FAVORITES_CONTEXT_TITLE:["Favorites"],FAVORITES_CONTEXT_TYPE:["favorites"],GALLERY_CONTEXT_TITLE:["Gallery"],GALLERY_CONTEXT_TYPE:["gallery"],GROUP_CONTEXT_TITLE:["Group"],GROUP_CONTEXT_TYPE:["group"],PHOTO_LIST_CONTEXT_TITLE:["Photo list"],PHOTO_LIST_CONTEXT_TYPE:["photo list"],PHOTOS_OF_CONTEXT_TITLE:["Photos of"],PHOTOS_OF_CONTEXT_TYPE:["photos of"],PHOTOSTREAM_CONTEXT_TITLE:["Photostream"],PHOTOSTREAM_CONTEXT_TYPE:["photostream"],RELATED_FAVORITES_CONTEXT_TITLE:["Related favorites"],RELATED_FAVORITES_CONTEXT_TYPE:["related favorites"],SET_CONTEXT_TITLE:["Set"],SET_CONTEXT_TYPE:["set"],LOADING:["loading"]})},"@VERSION@",{requires:["intl"]});
YUI.add("fluid-group-coverphoto-view",function(e){e.FlickrView.create(this.name,e.namespace("Views")["fluid-coverphoto-view"],[],{langBundles:this.details.langBundles,subviewConfig:{"join-group-view":{requiredToShowOnClient:!0,doRefreshOnStatusChange:!0,requiredToShowOnServer:!1}},initializer:function(e){return e.hasJoin=!0,e.fullBleed=!1,this.appStateParams=e,this.groupId=e.groupId||e.nsid,this.subviewConfig["join-group-view"].hasMenu=this.appContext.flipper.isFlipped("enable-feed-card-caret"),this.constructor.superclass.initializer.call(this,e)},loadState:function(){var t=this,n=[];return n.push(t.appContext.getModel("group-info-models",this.groupId)),n.push(this.getViewer()),e.Promise.all(n).then(function(e){var n=t.get("models");n.groupInfo=e[0],n.group=n.groupInfo.getValue("group"),t.set("models",n),t.set("canEditCoverPhoto",n.group.getValue("isAdmin"))})},buildContainer:function(){var t={},n=this.get("models").group,r=e.URLHelper.generateGroupUrls(n);return t=e.merge(t,this.buildGroupCoverPhoto(),this.buildAvatar(),this.buildTitleBlock(r),this.buildMetadata(),this.buildJoinButton()),t.iconMessage=this.intlMessage({intlName:"header.CHANGE_YOUR_GROUP_ICON"}),this.constructor.superclass.buildContainer.call(this,t),this},activate:function(){this.signinPendingQueue=e.SigninHelper.checkPendingQueue(this.appContext);if(this.signinPendingQueue&&this.signinPendingQueue.length>0){var t=this.signinPendingQueue;for(var n=0;n<t.length;n++)if(t[n].key==="joingroup"&&t[n].value.id===this.groupId){this.subviews["join-group-view"].joinGroup(this.groupId);break}}return this.constructor.superclass.activate.call(this)},buildJoinButton:function(){return{"follow-view":this.subviews["join-group-view"].get("container")}},buildTitleBlock:function(e){return{titleBlock:{isGroup:!0,title:this.get("models").groupInfo.getValue("group").getValue("title"),titleLink:e.about,urls:{rules:e.rules}}}},buildMetadata:function(){var t=this.get("models").group,n=e.URLHelper.generateGroupUrls(t),r=t.getValue("poolCount"),i=t.getValue("memberCount"),s=t.getValue("topicCount"),o=t.getValue("dateCreated");return{metadata:[{date:o.toDate(),groupSince:!0},{groupsStats:!0,members:e.Number.format(e.Number.parse(Math.max(0,i)),{thousandsSeparator:",",decimalPlaces:0}),membersLink:n.members,poolLink:n.photos,discussionsLink:n.discussions,photosText:e.flutil.formatIntlPluralNumber(this.intlMessage({intlName:"header.COUNT_PHOTOS",count:r}),r),topicCount:e.Number.format(e.Number.parse(Math.max(0,s)),{thousandsSeparator:",",decimalPlaces:0})}]}},buildAvatar:function(){var t=this.get("models"),n=t&&this.get("models").group,r=n&&n.getValue("iconurls"),i=n&&n.getValue("bestIconURL"),s=n&&e.URLHelper.generateGroupUrls(n),o=!1;return n?(o=r.retina===i,{avatar:{canEdit:n.getValue("isAdmin"),editUrl:"/iconbuilder/?group="+n.getValue("id"),linkUrl:s.about,icon:{retina:o?i:null,lowres:o?null:i},type:"group"}}):null}})},"@VERSION@",{requires:["flickr-view","flickr-promise","url-helper","fluid-coverphoto-view","join-group-view","fluid-modal-view","signin-helper"],optional:["group-models","group-info-models","group-pool-models","photostream-models"],langBundles:["header","common","groups"]});
YUI.add("hermes-template-groups-toolbar-view",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){return'<div class="groups-toolbar-content">\n	<div class="groups-toolbar-share-content">\n		'+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["fluid-share-group-view"]:t,{name:"outlet",hash:{},data:i}))+"\n	</div>\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/groups-toolbar-view",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-share",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return" disable-sharing"},3:function(e,t,n,r,i){return' title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"share-modal.SHARING_DISABLED"},data:i}))+'" '},5:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression((s=(s=n.shareTooltip||(t!=null?t.shareTooltip:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"shareTooltip",hash:{},data:i}):s))+'"'},7:function(e,t,n,r,i){var s,o=t!=null?t:{};return"		<span "+((s=n["if"].call(o,t!=null?t.sharingDisabled:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.program(5,i,0),data:i}))!=null?s:"")+' class="fluid-share-button-label">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"share-modal.SHARE"},data:i}))+"</span>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<div class="fluid-share-button '+l((o=(o=n.extraShareButtonClassList||(t!=null?t.extraShareButtonClassList:t))!=null?o:a,typeof o===f?o.call(u,{name:"extraShareButtonClassList",hash:{},data:i}):o))+((s=n["if"].call(u,t!=null?t.sharingDisabled:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"\n'+((s=n["if"].call(u,t!=null?t.sharingDisabled:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.program(5,i,0),data:i}))!=null?s:"")+' tabindex="0">\n\n	<span '+((s=n["if"].call(u,t!=null?t.sharingDisabled:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.program(5,i,0),data:i}))!=null?s:"")+' class="fluid-share-icon '+l((o=(o=n.extraShareButtonIconClassList||(t!=null?t.extraShareButtonIconClassList:t))!=null?o:a,typeof o===f?o.call(u,{name:"extraShareButtonIconClassList",hash:{},data:i}):o))+'"></span>\n'+((s=n["if"].call(u,t!=null?t.showShareButtonLabel:t,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n </div>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
