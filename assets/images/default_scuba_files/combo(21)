YUI.add("group-home-route",function(e){function n(e){n.superclass.constructor.call(this,e)}var t=require("lib/helpers/type-validator");e.Routes[this.name]=n,e.extend(n,e.FlickrRoute,{langBundles:this.details.langBundles,run:function(n){var r={},i=this,s=n.params.group_id,o=["notadded","pending","donepending","deleted"],u=n.headers?n.headers["user-agent"]:!1,a=!1,f;return this.appContext.flipper.isFlipped("rebootify-group-home")?(u&&u.match(/^Twitterbot/i)!==null&&(a=!0),t.nsid(s)?r.id=s:r.pathAlias=s,o.forEach(function(e,t){e in n.query&&(f={type:e,value:Number(n.query[e])})}),this.appContext.getModel("group-info-models",r).then(function(t){return e.Promise.resolve({view:"group-home-page-view",params:{groupId:t.id,groupName:t.getValue("group").getValue("title"),pageParams:{page:1,fetchPageSize:10,viewPageSize:10,nominalPage:1},isTwitterbot:a,showLess:!0,notification:f,showPool:t.getValue("group").getValue("isMember")||t.getValue("group").getValue("showPoolToNonMembers"),showDiscussion:t.getValue("group").getValue("isMember")||t.getValue("group").getValue("showDiscussionToNonMembers")},title:t.getValue("group").getValue("title")})},function(t){if(t.code===2)return e.Promise.resolve({view:"group-interstitial-view",isPrivateGroup:!0,params:{nsid:s,message:i.intlMessage({intlName:"groups.PRIVATE_GROUP"}),buttons:[{href:e.url(),title:i.intlMessage({intlName:"groups.RETURN_HOME"})}],isTwitterbot:a,isPrivateGroup:!0}});var r="Couldn't load group home page";return t.message&&(r+=": "+t.message),t.fatal?e.Promise.resolve({view:"group-loading-view",params:{}}):i.displayRouteErrors(n,new e.RouteError(404,r))})):this.displayServerErrorOrClientRedirect(n,"You don't have rebootify-group-home flipped on")}}),e.mix(n.prototype,e.Localizable)},"@VERSION@",{requires:["flickr-route","flickr-promise","group-info-models"],langBundles:["groups","common"]});
