/**
 * BetterWeather v1.4
 * Author: BetterStudio (http://themeforest.net/user/Better-Studio)
 * @license BetterStudio
*/
!function($){$.betterWeather=function(e,t){var a=this;a.$el=$(e),a.el=e,a.$el.data("betterWeather",a),a.tries=1,a.templateInitialized=!1,a.retina=window.devicePixelRatio>1,a.defaultOptions={source:"forecast",apiKey:"",location:"",locationName:"",showLocation:!0,showDate:!0,visitorLocation:!1,fontColor:"#fff",bgColor:"#4f4f4f",style:"normal",nextDays:!0,animatedIcons:!0,naturalBackground:!0,url:"better-weather/ajax/ajax.php",unit:"C",showUnit:!1,mode:"widget",inlineSize:"medium"},a.elements={location:"",date:"",currentlyDegree:"",upDegree:"",summary:"",summaryIconContainer:"",day1Title:"",day1Degree:"",day1IconContainer:"",day2Title:"",day2Degree:"",day2IconContainer:"",day3Title:"",day3Degree:"",day3IconContainer:"",day4Title:"",day4Degree:"",day4IconContainer:""},a.monthList={January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December"},a.daysList={Sat:"Sat",Sun:"Sun",Mon:"Mon",Tue:"Tue",Wed:"Wed",Thu:"Thu",Fri:"Fri"},a.stateList={clear:"Clear",rain:"Rain",snow:"Snow",sleet:"Sleet",wind:"Wind",foggy:"Foggy",cloudy:"Cloudy",mostly_cloudy:"Mostly Cloudy",partly_cloudy:"Partly Cloudy",thunderstorm:"Thunderstorm",drizzle:"Drizzle",light_Rain:"Light Rain",breezy_and_Partly_Cloudy:"breezy and Partly Cloudy",overcast:"Overcast"},a.data={latitude:"",longitude:"",timezone:"",currently:{time:"",summary:"",icon:"",nearestStormDistance:"",nearestStormBearing:"",precipIntensity:"",precipProbability:"",temperature:"",apparentTemperature:"",dewPoint:"",humidity:"",windSpeed:"",windBearing:"",visibility:"",cloudCover:"",pressure:"",ozone:"",temperatureMin:"",temperatureMax:"",sunriseTime:"",sunsetTime:""},daily:[{dayName:"",time:"",icon:""},{dayName:"",time:"",icon:""},{dayName:"",time:"",icon:""},{dayName:"",time:"",icon:""}]},a.init=function(){if(a.options=$.extend({},a.defaultOptions,t),a.helper.showLoader(),a.initColor(),a.initStyle(),""===a.options.apiKey){if("undefined"==typeof BW_Localized||null===BW_Localized||"undefined"==typeof BW_Localized.apiKey||null===BW_Localized.apiKey)return a.helper.hideLoader(),void a.helper.log("error","No API Key provided! "," Obtain API Key from https://developers.forecast.io");a.options.apiKey=BW_Localized.apiKey}a.getDataAjax()},a.initTemplate=function(){a.helper.cleanLog(),a.templateInitialized!==!0&&(a.templateInitialized=!0,"widget"===a.options.mode?(a.options.naturalBackground&&a.$el.addClass("with-natural-background"),a.options.showUnit&&a.$el.addClass("unit-showed"),a.$el.append(a.helper.templateWidgetCurrently),a.options.showLocation?a.elements.location=a.$el.find(".bw_currently .bw_location"):(a.$el.find(".bw_currently .bw_location").remove(),a.$el.find(".bw_currently .bw_separator").remove()),a.options.showDate?a.elements.date=a.$el.find(".bw_currently .bw_date"):(a.$el.find(".bw_currently .bw_date").remove(),a.$el.find(".bw_currently .bw_separator").remove()),a.elements.currentlyDegree=a.$el.find(".bw_currently .bw_degree"),a.elements.upDegree=a.$el.find(".bw_currently .bw_up-degree"),a.elements.downDegree=a.$el.find(".bw_currently .bw_down-degree"),a.elements.summaryIconContainer=a.$el.find(".bw_currently .bw_summary .bw_icon-container"),a.elements.summary=a.$el.find(".bw_currently .bw_summary p"),a.options.nextDays&&(a.$el.addClass("have-next-days"),a.$el.append(a.helper.templateWidgetNextDays),a.elements.day1Title=a.$el.find(".bw_days .bw_day-1 .bw_day-title"),a.elements.day1IconContainer=a.$el.find(".bw_days .bw_day-1 .bw_icon-container"),a.elements.day2Title=a.$el.find(".bw_days .bw_day-2 .bw_day-title"),a.elements.day2IconContainer=a.$el.find(".bw_days .bw_day-2 .bw_icon-container"),a.elements.day3Title=a.$el.find(".bw_days .bw_day-3 .bw_day-title"),a.elements.day3IconContainer=a.$el.find(".bw_days .bw_day-3 .bw_icon-container"),a.elements.day4Title=a.$el.find(".bw_days .bw_day-4 .bw_day-title"),a.elements.day4IconContainer=a.$el.find(".bw_days .bw_day-4 .bw_icon-container")),a.initIcons(),a.prettifyIconSize(),$(window).resize(function(){a.prettifyIconSize()})):"inline"===a.options.mode&&(a.$el.append(a.helper.templateInlineCurrently),a.elements.summaryIconContainer=a.$el.find(".bw_icon_container"),a.elements.currentlyDegree=a.$el.find(".bw_temperature"),a.elements.summary=a.$el.find(".bw_summary"),a.initIcons()))},a.refreshData=function(){if("widget"===a.options.mode){a.$el.addClass("state-"+a.data.currently.icon);var e=new Date(1e3*a.data.currently.sunriseTime),t=new Date(1e3*a.data.currently.sunsetTime),n=new Date,i=new Date(n.getTime()+-18e5),o=new Date(n.getTime()+18e5);if(e>=i&&o>=e?(a.$el.removeClass("state-"+a.data.currently.icon),a.$el.addClass("state-sunrise")):t>=i&&o>=t&&(a.$el.removeClass("state-"+a.data.currently.icon),a.$el.addClass("state-sunset")),a.helper.setIconTo(a.data.currently.icon,a.elements.summaryIconContainer.find(".bw_icon")),a.elements.summary.text(a.helper.getStateName(a.data.currently.summary)),a.elements.currentlyDegree.find("p").text(a.helper.getPrettyTemperature(a.data.currently.temperature)),a.elements.upDegree.text(a.helper.getPrettyTemperature(a.data.currently.temperatureMax)),a.elements.downDegree.text(a.helper.getPrettyTemperature(a.data.currently.temperatureMin)),a.options.showDate){var r=new Date(1e3*a.data.currently.time);a.elements.date.text(r.getDate()+" "+a.helper.getMonth(r.getMonth()+1))}if(a.options.showLocation)if(""!==a.options.locationName)a.elements.location.text(a.options.locationName);else{var l=a.data.timezone;l=l.split("/"),l=l[l.length-1].replace("_"," "),a.elements.location.text(l)}a.options.nextDays&&(a.helper.setIconTo(a.data.daily[1].icon,a.elements.day1IconContainer.find(".bw_icon")),a.elements.day1Title.text(a.helper.getDayName(a.data.daily[1].dayName)),a.helper.setIconTo(a.data.daily[2].icon,a.elements.day2IconContainer.find(".bw_icon")),a.elements.day2Title.text(a.helper.getDayName(a.data.daily[2].dayName)),a.helper.setIconTo(a.data.daily[3].icon,a.elements.day3IconContainer.find(".bw_icon")),a.elements.day3Title.text(a.helper.getDayName(a.data.daily[3].dayName)),a.helper.setIconTo(a.data.daily[4].icon,a.elements.day4IconContainer.find(".bw_icon")),a.elements.day4Title.text(a.helper.getDayName(a.data.daily[4].dayName)))}else"inline"===a.options.mode&&(a.$el.addClass("state-"+a.data.currently.icon),a.helper.setIconTo(a.data.currently.icon,a.elements.summaryIconContainer.find(".bw_icon")),a.elements.summary.text(a.helper.getStateName(a.data.currently.summary)),a.elements.currentlyDegree.text(a.helper.getPrettyTemperature(a.data.currently.temperature)))},a.emptyData=function(){if("inline "!==a.options.mode){if(a.initTemplate(),a.$el.addClass("state-no-data"),a.elements.summary.text("N/A"),a.elements.currentlyDegree.find("p").text("N/A"),a.elements.upDegree.text("N/A"),a.elements.downDegree.text("N/A"),a.options.showDate){var e=new Date;a.elements.date.text(e.getDate()+" "+a.helper.getMonth(e.getMonth()+1))}a.options.showLocation&&a.elements.location.text(""!==a.options.locationName?a.options.locationName:"N/A"),a.options.nextDays&&(a.elements.day1Title.text("N/A"),a.elements.day2Title.text("N/A"),a.elements.day3Title.text("N/A"),a.elements.day4Title.text("N/A"))}},a.initColor=function(){"widget"===a.options.mode&&(a.options.naturalBackground||a.$el.css("background-color",a.options.bgColor)),a.$el.css("color",a.options.fontColor)},a.initStyle=function(){"widget"===a.options.mode?(a.$el.addClass("style-"+a.options.style),a.$el.addClass("better-weather")):"inline"===a.options.mode&&(a.$el.addClass("bw_size-"+a.options.inlineSize),a.$el.addClass("better-weather-inline"))},a.initIcons=function(){if("widget"===a.options.mode)a.helper.isCanvasSupported()&&(a.skycons=new Skycons({color:a.options.fontColor,dropShadow:!0})),"normal"===a.options.style?a.helper.addCanvasTo(a.elements.summaryIconContainer,a.$el.attr("id")+"-summary-icon",85,85):a.helper.addCanvasTo(a.elements.summaryIconContainer,a.$el.attr("id")+"-summary-icon",55,55),a.options.nextDays&&(a.helper.addCanvasTo(a.elements.day1IconContainer,a.$el.attr("id")+"-day1-icon",17,17),a.helper.addCanvasTo(a.elements.day2IconContainer,a.$el.attr("id")+"-day2-icon",17,17),a.helper.addCanvasTo(a.elements.day3IconContainer,a.$el.attr("id")+"-day3-icon",17,17),a.helper.addCanvasTo(a.elements.day4IconContainer,a.$el.attr("id")+"-day4-icon",17,17));else if("inline"===a.options.mode){a.helper.isCanvasSupported()&&(a.skycons=new Skycons({color:a.options.fontColor,dropShadow:!1}));var e="",t="";switch(a.options.inlineSize){case"small":t=e=18;break;case"medium":t=e=30;break;case"large":t=e=55}a.helper.addCanvasTo(a.elements.summaryIconContainer,a.$el.attr("id")+"-summary-icon",e,t)}},a.prettifyIconSize=function(){var e=a.$el.width(),t=a.elements.summaryIconContainer.find(".bw_icon");if(!t.hasClass("hw_static-icon"))switch(!0){case 70>=e:a.helper.updateIconSize(t,28,28);break;case 100>=e:a.helper.updateIconSize(t,35,35);break;case 200>=e:a.helper.updateIconSize(t,40,40);break;case 400>=e:"modern"===a.options.style?a.helper.updateIconSize(t,55,55):"normal"===a.options.style&&a.helper.updateIconSize(t,70,70);break;case 1170>=e:a.helper.updateIconSize(t,35,35)}},a.getDataAjax=function(){var e="location="+a.options.location;e+="&apikey="+a.options.apiKey,e+="&source="+a.options.source,a.options.visitorLocation&&(e+="&visitor_location=true"),"undefined"!=typeof BW_Localized.action&&(e+="&action="+BW_Localized.action),jQuery.ajax({type:"POST",url:a.helper.getAjaxURL(),data:e,dataType:"json",success:function(e){switch(e.status){case"succeed":a.data=e.data,a.initTemplate(),a.helper.hideLoader(),a.refreshData();break;case"error":a.initTemplate(),a.helper.log("error",e.msg,e.data),a.tries<=2?(a.tries++,a.helper.log("alert","Better Weather Another Ajax call sent",""),setTimeout(function(){a.helper.log("alert","Better Weather another Ajax call sent.",""),a.getDataAjax()},3e3)):(a.helper.log("error","Critical problem in Better Weather Ajax calls","Better Weather sent 3 time Ajax Call but retried data has problem! Please check xml.php file and delete cache folder."),setTimeout(function(){a.emptyData(),a.helper.hideLoader()},2e3))}}})},a.helper={getCorretSize:function(e){return a.retina?2*e:e},updateIconSize:function(e,t,n){e.attr("width",a.helper.getCorretSize(t)),e.attr("height",a.helper.getCorretSize(n)),e.css("width",t+"px"),e.css("height",n+"px")},getAjaxURL:function(){return a.options.url!==a.defaultOptions.url?a.options.url:"undefined"!=typeof BW_Localized&&null!==BW_Localized&&"undefined"!=typeof BW_Localized.url&&null!==BW_Localized.url?BW_Localized.url:a.defaultOptions.url},showLoader:function(){"inline"!==a.options.mode&&0===a.$el.find(".bw-loader").length&&a.$el.append(a.helper.templateWidgetLoader)},hideLoader:function(){"inline"!==a.options.mode&&a.$el.find(".bw-loader").remove()},celsiusToFahrenheit:function(e){return 9*e/5+32},fahrenheitToCelsius:function(e){return 5*(e-32)/9},getPrettyTemperature:function(e){return"widget"===a.options.mode?"F"===a.options.unit?parseInt(e)+"°"+(a.options.showUnit?"F":""):parseInt(a.helper.fahrenheitToCelsius(e))+"°"+(a.options.showUnit?"C":""):"inline"===a.options.mode?"F"===a.options.unit?parseInt(e)+"°"+(a.options.showUnit?"F":""):parseInt(a.helper.fahrenheitToCelsius(e))+"°"+(a.options.showUnit?"C":""):void 0},getMonth:function(e){var t="";switch(e){case 1:t="January";break;case 2:t="February";break;case 3:t="March";break;case 4:t="April";break;case 5:t="May";break;case 6:t="June";break;case 7:t="July";break;case 8:t="August";break;case 9:t="September";break;case 10:t="October";break;case 11:t="November";break;case 12:t="December"}return"undefined"!=typeof BW_Localized&&null!==BW_Localized&&"undefined"!=typeof BW_Localized.monthList&&null!==BW_Localized.monthList&&"undefined"!=typeof BW_Localized.monthList[t]&&null!==BW_Localized.monthList[t]?BW_Localized.monthList[t]:a.monthList[t]},getDayName:function(e){return"undefined"!=typeof BW_Localized&&null!==BW_Localized&&"undefined"!=typeof BW_Localized.daysList&&null!==BW_Localized.daysList&&"undefined"!=typeof BW_Localized.daysList[e]&&null!==BW_Localized.daysList[e]?BW_Localized.daysList[e]:a.daysList[e]},getStateName:function(e){var t=e.toLowerCase();return t=t.replace(" ","_"),t=t.replace("-","_"),"undefined"!=typeof BW_Localized&&null!==BW_Localized&&"undefined"!=typeof BW_Localized.stateList&&null!==BW_Localized.stateList&&"undefined"!=typeof BW_Localized.stateList[t]&&null!==BW_Localized.stateList[t]?BW_Localized.stateList[t]:"undefined"!=typeof a.stateList[t]&&null!==a.stateList[t]?a.stateList[t]:e},log:function(e,t,n){switch(e){case"error":"widget"===a.options.mode?(0===a.$el.find(".bw-error").length&&a.$el.append(a.helper.templateWidgetErrors),a.$el.find(".bw-error .bw-error-title").text(t),console.log((""===t?"":t+":")+n)):console.log((""===t?"":t+":")+n);break;case"alert":console.log((""===t?"":t+":")+n)}},cleanLog:function(){a.$el.find(".bw-error").remove()},isCanvasSupported:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},allowedIcons:["clear-day","clear-night","rain","snow","sleet","wind","fog","cloudy","partly-cloudy-day","partly-cloudy-night"],setIconTo:function(e,t){if(a.helper.isCanvasSupported()&&$.inArray(e,a.helper.allowedIcons)>=0&&a.options.animatedIcons===!0)a.skycons.set(t.attr("id"),e),a.skycons.play();else{t.addClass("bw_"+e);var n="";switch(e){case"clear-day":n="wi-day-sunny";break;case"clear-night":n="wi-night-clear";break;case"rain":n="wi-rain";break;case"snow":n="wi-snow";break;case"sleet":n="wi-rain";break;case"wind":n="wi-strong-wind";break;case"thunderstorm":n="wi-lightning";break;case"cloudy":n="wi-cloudy";break;case"partly-cloudy-day":n="wi-day-cloudy";break;case"partly-cloudy-night":n="wi-night-cloudy"}"thunderstorm"===e?(t.parent().append('<i class="'+n+'"></i>'),t.parent().find("canvas").remove()):t.append('<i class="'+n+'"></i>')}},addCanvasTo:function(e,t,n,i){e.append(a.helper.isCanvasSupported()&&a.options.animatedIcons===!0?'<canvas id="'+t+'" class="bw_icon bw_svg-icon" width="'+a.helper.getCorretSize(n)+'" height="'+a.helper.getCorretSize(i)+'" style="height:'+i+"px; width:"+n+'px;"></canvas>':'<span id="'+t+'" class="bw_icon hw_static-icon" ></span>')},templateInlineCurrently:'<span class="bw_icon_container"></span><span class="bw_temperature"></span><span class="bw_summary"></span>',templateWidgetErrors:'<div class="bw-error"><p class="bw-error-sign">&#x26a0;</p><p class="bw-error-title"></p><p class="bw-error-text"></p></div>',templateWidgetLoader:'<div class="bw-loader"></div>',templateWidgetCurrently:'<div class="bw_currently"><div class="bw_date-loc"><span class="bw_location"></span><span class="bw_separator">-</span><span class="bw_date"></span></div><div class="bw_degree-up-down"><span class="bw_up-degree"></span><span class="bw_down-degree"></span></div><div class="bw_summary"><span class="bw_icon-container"></span><p></p></div><div class="bw_degree"><p></p></div></div>',templateWidgetNextDays:'<div class="bw_days"><ul class="bw_days-list"><li class="bw_day-item bw_day-1"><p class="bw_day-title"></p><span class="bw_icon-container"></span></li><li class="bw_day-item bw_day-2"><p class="bw_day-title"></p><span class="bw_icon-container"></span></li><li class="bw_day-item bw_day-3"><p class="bw_day-title"></p><span class="bw_icon-container"></span></li><li class="bw_day-item bw_day-4"><p class="bw_day-title"></p><span class="bw_icon-container"></span></li></ul></div>'},a.init()},$.fn.betterWeather=function(e){return this.each(function(){new $.betterWeather(this,e)})},elementQuery({".better-weather":{"max-width":["2000px","1170px","970px","900px","830px","650px","550px","400px","350px","300px","250px","200px","170px","120px","100px","50px"]}})}(jQuery);